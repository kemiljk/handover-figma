<style>
  * {
    outline: none;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    margin: 1em;
    color: #1A202C
  }


  h2 {
    margin: 0;
    font-size: larger;
  }

  h3 {
    margin-left: 0;
    margin-top: 1.25em;
    margin-right: auto;
    margin-bottom: 0;
  }

  h4 {
    margin: auto;
    margin-left: 0;
    padding-right: 1em;
    font-weight: 900;
    color: #009688
  }

  h5 {
    margin: 0;
  }

  p {
    margin-bottom: 0.5em;
    font-size: small;
    color: #4A5568;
  }

  select {
    width: 15em;
    height: 2.7em;
  }

  #em {
    color: #ff9800;
    padding-left: 1em;
  }

  #container {
    display: grid;
    position: absolute;
  }



  .container {
    display: flex;
    margin-top: 1em;
  }

  .changeValue {
    border: 3px solid #009688;
    border-radius: 4px;
    height: 2.3em;
    width: 4.5em;
    text-align: center;
    font-size: small;
  }

  .input {
    border: 3px solid #009688;
    border-radius: 4px;
    height: 2em;
    width: 4.5em;
    text-align: center;
    font-size: small;
  }

  .result {
    height: 3em;
    width: 5em;
    text-align: center;
    font-size: medium;
    display: flex;
    float: right;
    margin-right: 3em;
  }

  .converter {
    display: flex;
    margin: auto;
    margin-top: 0;
    margin-left: 0;
    margin-bottom: .5em;
    justify-content: space-between;
    align-items: center;
  }

  .baseValue {
    display: flex;
    margin-top: .5em;
    margin-bottom: 0;
  }

  .f-l {
    float: left;
  }

  .f-r {
    float: right;
  }

  .value {
    margin: auto;
    color: #009688;
    font-weight: 700;
    font-size: x-large;
  }

  .btn {
    border-radius: 4px;
    color: white;
    text-transform: uppercase;
    font-weight: 600;
    padding: 0.5em .75em;
    cursor: pointer;
  }

  .text {
    outline: none;
    border: none;
  }

  .orange--text {
    color: #ff9800;
  }

  .orange--outline {
    border: 3px solid #ff9800;
  }

  .black--text {
    color: #1A202C;
  }

  .black--outline {
    border: 3px solid #1A202C;
  }

  .green {
    background: #009688;
    border: 3px solid #009688;
  }

  .float-right {
    display: flex;
    float: right;
    margin: auto;
  }

  .mr-0 {
    margin-right: 0;
  }

  .ml-1 {
    margin-left: 1em;
  }

  .mr-1 {
    margin-right: 1em;
  }

  .mr-2 {
    margin-right: 2em;
  }

  .mb-1 {
    margin-bottom: 1em;
  }
</style>

<div id="container">
  <h2>Convert PX to EMs</h2>
  <!-- <p>Enter a <em>pixel</em> value in the left input and click convert to see the relative <em>em</em> value.</p> -->
  <p>The base <em>pixel</em> value is 16px with a scale of 1. <br />Change the base value and/or scale below.</p>
  <div>
    <div class="baseValue f-l mr-2">
      <h5 class="mr-2">Base px</h5>
      <h5 class="">Scale</h5>
    </div>
    <div class="baseValue f-l">
      <input class="changeValue orange--outline mr-1" id="newPx" value="16">
      <select name="conversionScale" id="scale" class="orange--outline">
        <option value="1.000" selected>Browser default (1.000)</option>
        <option value="1.067">Minor second (1.067)</option>
        <option value="1.125">Major second (1.125)</option>
        <option value="1.200">Minor third (1.200)</option>
        <option value="1.250">Major third (1.250)</option>
        <option value="1.333">Perfect fourth (1.333)</option>
        <option value="1.414">Augmented fourth (1.414)</option>
        <option value="1.500">Perfect fifth (1.500)</option>
        <option value="1.618">Golden ratio (1.618)</option>
      </select>
    </div>
  </div>
  <h3>Results</h3>
  <div class="converter">
    <h4>PX</h4>
    <div>
      <input class="input" id="px" value="16">
    </div>
    </h5>
    <div class="result">
      <h4 id="em">EM</h4>
      <span id="result" class="value">1.00</span>
    </div>
  </div>
  <div class="bottom">
    <button id="convert" class="btn green">Convert</button>
  </div>
</div>

<script>

  onmessage = (event) => {
    document.getElementById('px').value = event.data.pluginMessage.fontSize;
    /* console.log(event.data.pluginMessage); */
  }

  document.getElementById('convert').onclick = () => {
    const input = document.getElementById('px');
    var result = pxToEms(input.value);
    document.getElementById('result').innerHTML = result().toFixed(2);

    input.addEventListener("keyup", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        document.getElementById('convert').click();
      }
    });
    const basePx = document.getElementById('newPx'); 
    basePx.addEventListener("keyup", function (event) {
      if (event.keyCode === 13) {
        event.preventDefault();
        document.getElementById('convert').click();
      }
    });
  }

  function pxToEms(px) {
    var baseValue = document.getElementById('newPx').value;
    var scale = document.getElementById('scale').value

    function calculate() {
      return (px / baseValue) * scale;
    }

    return calculate;
  }


</script>