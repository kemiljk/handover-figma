<head>
  <link href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css" rel="stylesheet">
</head>

<div id="container" class="flex mx-auto w-full py-2 px-4">
  <div class="w-full">
    <h1 class="py-4 font-black text-xl">Convert Pixels to Rem</h1>
    <p class="text-base font-medium pb-2 text-gray-600">The base <em>pixel</em> value is 16px with a scale of 1. <br />Change the base value and/or scale below.</p>
  </div>
</div>
<div class="flex mx-auto w-full py-1 px-4">
    <div class="flex flex-col w-1/4">
      <h5 class="pb-2 font-bold text-base">Base px</h5>
      <input class="w-24 py-2 px-4 text-base font-medium border-2 border-yellow-600 rounded-xl focus:outline-none ring-2 ring-yellow-600 focus:ring-2 focus:ring-yellow-600" id="newPx" value="16">
    </div>
    <div class="flex flex-col w-3/4">
      <h5 class="pb-2 font-bold text-base">Scale</h5>
      <div class="relative">
        <select name="conversionScale" id="scale" class="w-full py-2.5 px-4 text-base font-medium border-2 border-yellow-600 rounded-xl focus:outline-none ring-2 ring-yellow-600 focus:ring-2 focus:ring-yellow-600">
          <option value="1.000" selected>Browser default (1.000)</option>
          <option value="1.067">Minor second (1.067)</option>
          <option value="1.125">Major second (1.125)</option>
          <option value="1.200">Minor third (1.200)</option>
          <option value="1.250">Major third (1.250)</option>
          <option value="1.333">Perfect fourth (1.333)</option>
          <option value="1.414">Augmented fourth (1.414)</option>
          <option value="1.500">Perfect fifth (1.500)</option>
          <option value="1.618">Golden ratio (1.618)</option>
        </select>
      </div>
    </div>
  </div>
  <div class="flex mx-auto w-full py-1 px-4">
  <div class="w-2/3 space-y-2">
    <h3 class="pb-2 pt-4 font-bold text-base">Selections</h3>
    <div class="flex pr-2 w-full items-center pb-4">
      <input class="w-24 py-2 px-4 text-base font-medium border-2 border-green-600 rounded-xl focus:outline-none ring-2 ring-green-700 focus:ring-2 focus:ring-green-600" id="textPx" value="16">
      <h4 class="pl-4 font-medium text-base">Text pixels</h4>
    </div>
    <div class="flex pr-2 w-full items-center pb-4">
      <input class="w-24 py-2 px-4 text-base font-medium border-2 border-green-600 rounded-xl focus:outline-none ring-2 ring-green-700 focus:ring-2 focus:ring-green-600" id="widthPx" value="16">
      <h4 class="pl-4 font-medium text-base">Width pixels</h4>
    </div>
    <div class="flex pr-2 w-full items-center pb-4">
      <input class="w-24 py-2 px-4 text-base font-medium border-2 border-green-600 rounded-xl focus:outline-none ring-2 ring-green-700 focus:ring-2 focus:ring-green-600" id="heightPx" value="16">
      <h4 class="pl-4 font-medium text-base">Height pixels</h4>
    </div>
  </div>
  <div class="w-1/3 space-y-2">
    <h3 class="pb-2 pt-4 font-bold text-lg">Result (rem)</h3>
      <div class="flex w-full items-center pb-4">
        <p id="textResult" class="w-full py-2 text-xl font-black text-green-600">1.00</p>
      </div>
      <div class="flex w-full items-center pb-4 pt-1">
        <p id="widthResult" class="w-full py-2 text-xl font-black text-green-600">1.00</p>
      </div>
      <div class="flex w-full items-center pb-4 pt-1">
        <p id="heightResult" class="w-full py-2 text-xl font-black text-green-600">1.00</p>
      </div>
    </div>
  </div>
<div class="fixed bottom-6 left-0 right-0 mx-auto flex justify-center">
  <div class="flex justify-center w-full">
    <button id="convert" class="text-center text-white font-bold bg-green-600 py-4  w-64 rounded-full focus:outline-none">Convert</button>
  </div>
</div>
</div>

<script>
  onmessage = (event) => {
    if (event.data.pluginMessage.fontSize) {
      document.getElementById('textPx').value = event.data.pluginMessage.fontSize;
    }
    else if (event.data.pluginMessage.width) {
      document.getElementById('widthPx').value = event.data.pluginMessage.width.toFixed(0);
    }
    else if (event.data.pluginMessage.height) {
      document.getElementById('heightPx').value = event.data.pluginMessage.height.toFixed(0);
    }

    document.getElementById('convert').onclick = () => {
      if (event.data.pluginMessage.fontSize) {
        const text = document.getElementById('textPx');
        var result = pxToRem(text.value);
        document.getElementById('textResult').innerHTML = (result().toFixed(2) || null);
      }
      if  (event.data.pluginMessage.width ||  event.data.pluginMessage.height) {
        const width = document.getElementById('widthPx');
        var result = pxToRem(width.value);
        document.getElementById('widthResult').innerHTML = (result().toFixed(2) || null);
        const height = document.getElementById('heightPx');
        var result = pxToRem(height.value);
        document.getElementById('heightResult').innerHTML = (result().toFixed(2) || null);
      }
    }
  }

  function pxToRem(px) {
    var baseValue = document.getElementById('newPx').value;
    var scale = document.getElementById('scale').value;

    function calculate() {
      return (px / baseValue) * scale;
    }

    return calculate;
  }
</script>
